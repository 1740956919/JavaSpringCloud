webpackJsonp([2],{558:function(e,t,a){a(631),a(632);var n=a(218)(a(577),a(613),"data-v-6288eddf",null);e.exports=n.exports},577:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(219),r=a.n(n);t.default={data:function(){return{dialogImageUrl:"",dialogVisible:!1,loading:"",tenantForm:{tenantName:"",tenadtId:"",activeFlag:"",instanceConfig:"",maxProjectNum:"",maxUserNum:"",masterServerCode:"",slaveServerCode:"",masterServers:[],slaveServers:[],inactiveDate:"",funConfig:[],logoUrl:[],newPicUrl:[]},logoList:[],newList:[],queryServersUrl:this.$store.state.url+"operation/tenant/queryServers",saveTenantUrl:this.$store.state.url+"operation/tenant/saveTenant",uploadPictureUrl:this.$store.state.url+"operation/tenant/uploadImg",rules:{}}},mounted:function(){this.$nextTick(function(){this.queryServers()})},created:function(){this.tenantForm={tenantName:"",tenadtId:"",activeFlag:"",instanceConfig:"",maxProjectNum:"",maxUserNum:"",masterServerCode:"",slaveServerCode:"",masterServers:[],slaveServers:[],inactiveDate:"",funConfig:[],logoUrl:[],newPicUrl:[]}},methods:{logoSuccess:function(e,t,a){console.log(a),this.$forceUpdate(),this.$message({showClose:!0,message:"租户logo上传成功",type:"success"}),this.logoList=a},logoFail:function(){this.$message.error("租户logo上传失败，请重新上传")},logoRemove:function(e,t){this.logoList=t},newSuccess:function(e,t,a){this.$forceUpdate(),this.$message({showClose:!0,message:"新闻图片上传成功",type:"success"}),this.newList=a},newFail:function(){this.$message.error("新闻图片上传失败，请重新上传")},newRemove:function(e,t){this.newList=t},saveTenant:function(e){for(var t=this,a=[],n=[],o=[],l=0;l<this.logoList.length;l++){var s={};console.log(this.logoList[l].response.data),this.logoList[l].response.data&&(s.url=this.logoList[l].response.data[0],a.push(s))}for(var l=0;l<this.newList.length;l++){var s={};this.newList[l].response.data&&(s.url=this.newList[l].response.data[0],o.push(this.newList[l].response.data[0]),n.push(s))}this.tenantForm.logoUrl=a,this.tenantForm.newPicUrl=n,this.$refs[e].validate(function(e){if(!e)return!1;t.openFullScreen();var n=new URLSearchParams;n.append("tenantName",t.tenantForm.tenantName),n.append("masterServerCode",t.tenantForm.masterServerCode),n.append("slaveServerCode",t.tenantForm.slaveServerCode),a.length?n.append("logoUrl",a[0].url):n.append("logoUrl","http://fomtest.zjmi-mall.com/42ab5fa2b2b94c138d6819f9b4917d3c.jpg"),n.append("newPicUrl",o),n.append("instanceConfig",t.tenantForm.instanceConfig),n.append("activeFlag",t.tenantForm.activeFlag),n.append("homeStatisticsFlag",0),n.append("onlinePaymentFlag",0),n.append("yinlianWithhodeFlag",0),n.append("maxProjectNum",t.tenantForm.maxProjectNum),n.append("maxUserNum",t.tenantForm.maxUserNum),n.append("inactiveDate",t.tenantForm.inactiveDate);for(var l=0;l<t.tenantForm.funConfig.length;l++)"启用首页统计"==t.tenantForm.funConfig[l]&&n.set("homeStatisticsFlag",1),"启用在线缴费"==t.tenantForm.funConfig[l]&&n.set("onlinePaymentFlag",1),"启用银联在线代扣"==t.tenantForm.funConfig[l]&&n.set("yinlianWithhodeFlag",1);t.$axios.post(t.saveTenantUrl,n).then(function(e){if(0==e.data.code){t.loading.close();var a=0,n=!0,o=!1,l=void 0;try{for(var s,i=r()(t.$store.state.options);!(n=(s=i.next()).done);n=!0){if("/addTenant"===s.value.index)break;a++}}catch(e){o=!0,l=e}finally{try{!n&&i.return&&i.return()}finally{if(o)throw l}}t.$store.state.options.splice(a,1),t.$router.push("/operationState"),t.tenantForm={tenantName:"",tenadtId:"",activeFlag:"",instanceConfig:"",maxProjectNum:"",maxUserNum:"",masterServerCode:"",slaveServerCode:"",masterServers:[],slaveServers:[],inactiveDate:"",funConfig:[],logoUrl:[],newPicUrl:[]}}else t.$message({showClose:!0,message:e.data.msg,type:"error"}),t.$store.commit("toLogin")})})},closeaddTenant:function(){var e=0,t=!0,a=!1,n=void 0;try{for(var o,l=r()(this.$store.state.options);!(t=(o=l.next()).done);t=!0){if("/addTenant"===o.value.index)break;e++}}catch(e){a=!0,n=e}finally{try{!t&&l.return&&l.return()}finally{if(a)throw n}}this.$store.state.options.splice(e,1),this.$router.push("/operationState")},queryServers:function(){var e=this;this.$axios.post(this.queryServersUrl).then(function(t){if(0==t.data.code)for(var a=0;a<t.data.data.length;a++)1==t.data.data[a].serverType?e.tenantForm.masterServers.push(t.data.data[a]):e.tenantForm.slaveServers.push(t.data.data[a]);else e.$message({showClose:!0,message:t.data.msg,type:"error"})})},openFullScreen:function(){this.loading=this.$loading({lock:!0,text:"操作中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"})}}}},590:function(e,t,a){t=e.exports=a(95)(!1),t.push([e.i,".tenantPage .el-upload-list{width:600px;border:1px solid #c0c4cc;min-height:100px;padding:5px}.tenantPage .upload-demo .el-upload{position:absolute;right:90px;top:0;background-color:#fff;border:none;line-height:0;width:10px}.tenantPage .el-upload-list--picture-card{display:block}.tenantPage .el-date-editor.el-input,.tenantPage .el-form-item .el-input__inner{width:300px}.tenantPage .pzStyle .el-input__inner{width:715px}.tenantPage .configStyle .el-form-item__content{border:1px solid #c0c4cc;padding:5px 15px}.tenantPage .configStyle .el-checkbox{display:block;margin:0}.avatar-uploader .el-upload{border:1px solid #d9d9d9;border-radius:6px;cursor:pointer;position:relative;overflow:hidden}.avatar-uploader .el-upload:hover{border-color:#409eff}.avatar-uploader .avatar-uploader-icon{font-size:28px;color:#8c939d;width:178px;height:178px;line-height:178px;text-align:center}.avatar{width:100%;height:178px;display:block}.tenantPage .el-progress{display:none;width:100px;height:100px}.tenantPage .el-upload-list__item{width:100px;height:100px}",""])},591:function(e,t,a){t=e.exports=a(95)(!1),t.push([e.i,"",""])},613:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"tenantPage"},[a("el-form",{ref:"tenantForm",staticClass:"demo-form-inline",attrs:{inline:!0,model:e.tenantForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"租户名称",prop:"tenantName"}},[a("el-input",{attrs:{clearable:""},model:{value:e.tenantForm.tenantName,callback:function(t){e.$set(e.tenantForm,"tenantName",t)},expression:"tenantForm.tenantName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"租户ID",prop:"tenadtId"}},[a("el-input",{attrs:{clearable:"",disabled:""},model:{value:e.tenantForm.tenadtId,callback:function(t){e.$set(e.tenantForm,"tenadtId",t)},expression:"tenantForm.tenadtId"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"主服务器",prop:"masterServerCode"}},[a("el-select",{attrs:{placeholder:"请选择",clearable:"",filterable:""},model:{value:e.tenantForm.masterServerCode,callback:function(t){e.$set(e.tenantForm,"masterServerCode",t)},expression:"tenantForm.masterServerCode"}},e._l(e.tenantForm.masterServers,function(e){return a("el-option",{key:e.serverCode,attrs:{label:e.daName,value:e.serverCode}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"从服务器",prop:"slaveServerCode"}},[a("el-select",{attrs:{placeholder:"请选择",clearable:"",filterable:""},model:{value:e.tenantForm.slaveServerCode,callback:function(t){e.$set(e.tenantForm,"slaveServerCode",t)},expression:"tenantForm.slaveServerCode"}},e._l(e.tenantForm.slaveServers,function(e){return a("el-option",{key:e.serverCode,attrs:{label:e.daName,value:e.serverCode}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"租户Logo",prop:"logoUrl"}},[a("el-upload",{staticClass:"upload-demo",staticStyle:{width:"715px"},attrs:{action:e.uploadPictureUrl,"on-remove":e.logoRemove,"on-success":e.logoSuccess,"on-error":e.logoFail,"file-list":e.tenantForm.logoUrl,limit:1,"list-type":"picture-card"}},[a("el-button",{staticStyle:{width:"100px"},attrs:{size:"small",type:"primary"}},[e._v("浏览...")])],1)],1),e._v(" "),a("el-form-item",{staticStyle:{"margin-bottom":"20px"},attrs:{label:"新闻图片",prop:"newPicUrl"}},[a("el-upload",{staticClass:"upload-demo",staticStyle:{width:"715px"},attrs:{action:e.uploadPictureUrl,"on-remove":e.newRemove,"on-success":e.newSuccess,"on-error":e.newFail,"file-list":e.tenantForm.newPicUrl,"list-type":"picture-card",multiple:""}},[a("el-button",{staticStyle:{width:"100px"},attrs:{size:"small",type:"primary"}},[e._v("浏览...")])],1)],1),e._v(" "),a("el-form-item",{staticClass:"pzStyle",attrs:{label:"实例配置",prop:"instanceConfig"}},[a("el-input",{attrs:{clearable:""},model:{value:e.tenantForm.instanceConfig,callback:function(t){e.$set(e.tenantForm,"instanceConfig",t)},expression:"tenantForm.instanceConfig"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"715px"},attrs:{label:"是否生效",prop:"activeFlag"}},[a("el-switch",{attrs:{"active-value":"1","inactive-value":"0",disabled:""},model:{value:e.tenantForm.activeFlag,callback:function(t){e.$set(e.tenantForm,"activeFlag",t)},expression:"tenantForm.activeFlag"}})],1),e._v(" "),a("el-form-item",{staticClass:"configStyle",staticStyle:{width:"715px"},attrs:{label:"功能配置",prop:"funConfig"}},[a("el-checkbox-group",{model:{value:e.tenantForm.funConfig,callback:function(t){e.$set(e.tenantForm,"funConfig",t)},expression:"tenantForm.funConfig"}},[a("el-checkbox",{attrs:{label:"启用首页统计"}}),e._v(" "),a("el-checkbox",{attrs:{label:"启用在线缴费"}}),e._v(" "),a("el-checkbox",{attrs:{label:"启用银联在线代扣"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"最大项目数",prop:"maxProjectNum"}},[a("el-input",{attrs:{clearable:""},model:{value:e.tenantForm.maxProjectNum,callback:function(t){e.$set(e.tenantForm,"maxProjectNum",t)},expression:"tenantForm.maxProjectNum"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"最大用户数",prop:"maxUserNum"}},[a("el-input",{attrs:{clearable:""},model:{value:e.tenantForm.maxUserNum,callback:function(t){e.$set(e.tenantForm,"maxUserNum",t)},expression:"tenantForm.maxUserNum"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"失效时间",prop:"inactiveDate"}},[a("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择日期时间"},model:{value:e.tenantForm.inactiveDate,callback:function(t){e.$set(e.tenantForm,"inactiveDate",t)},expression:"tenantForm.inactiveDate"}})],1)],1),e._v(" "),a("div",{staticStyle:{"padding-bottom":"20px","text-align":"center",width:"900px"}},[a("el-button",{staticStyle:{width:"100px"},attrs:{type:"primary"},on:{click:function(t){e.saveTenant("tenantForm")}}},[e._v("保存")]),e._v(" "),a("el-button",{staticStyle:{width:"100px"},on:{click:e.closeaddTenant}},[e._v("取消")])],1)],1)])},staticRenderFns:[]}},631:function(e,t,a){var n=a(590);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);a(217)("4bd21ab0",n,!0)},632:function(e,t,a){var n=a(591);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);a(217)("34f10370",n,!0)}});